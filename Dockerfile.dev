FROM python:3.11-alpine

ARG USERNAME=user
ARG USER_UID=1000
ARG USER_GID=1000

WORKDIR /workspace

RUN apk add --no-cache \
    curl \
    git \
    bash \
    gcc \
    musl-dev \
    libffi-dev \
    openssl-dev \
    openssh

RUN addgroup -g ${USER_GID} ${USERNAME} && \
    adduser -D -u ${USER_UID} -G ${USERNAME} ${USERNAME}

USER ${USERNAME}

RUN pip install --no-cache-dir --user hatch
RUN curl -fsSL https://bun.sh/install | bash
ENV PATH="/home/${USERNAME}/.local/bin:/home/${USERNAME}/.bun/bin:${PATH}"

EXPOSE 5173 8000

CMD ["/bin/bash"]
